<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>ns-3: ns3::OnionRouting Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ns3_stylesheet.css" rel="stylesheet" type="text/css"/>
    <link href="favicon.ico" rel="shortcut icon" type="image/ico"></link>
    <script type="text/javascript" src="drop-down-menu.js"></script>
    <script type="text/javascript" src="ns3_version.js"></script>
    <script type="text/javascript" src="ns3_links.js"></script>
  </head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
	<table cellspacing="0" cellpadding="0" width="100%">
	  <tbody>
	    <tr style="height: 56px;">
	      <td id="projectlogo">
		<a id="ns3_home1"
		  href="http://www.nsnam.org/">
		  <img alt="ns-3 Logo"
		    src="ns-3-inverted-notext-small.png"/>
		</a>
	      </td>
	      <td id="projecttext">
		<div id="projectbrief">A Discrete-Event Network Simulator</div>
		<span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
	      </td>
	      <td id="ns3-menu">
		<div class="menu">
		  <ul >
		    <li><a id="ns3_home2"
			href="http://www.nsnam.org/"
			>&nbsp;&nbsp;Home</a>
		    </li>
		    <li><span
			onmouseover="mopen('mTuts')" 
			onmouseout="mclosetime()"
			>Tutorials &nbsp;&#x25BC;</span>
		      <div id="mTuts" 
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_tut"
			  href="/docs/tutorial/html/index.html"
			  >English</a><br/>
		    </li>
		    <li><span
			onmouseover="mopen('mDocs')" 
			onmouseout="mclosetime()"
			>Docs &nbsp;&nbsp;&nbsp;&#x25BC;</span>
		      <div id="mDocs"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_wiki"
			  href="http://www.nsnam.org/wiki"
			  >Wiki</a><br/>
			<a id="ns3_man"
			    href="/docs/manual/html/index.html"
			    >Manual</a><br/>
			<a id="ns3_mod"
			   href="/docs/models/html/index.html"
			   >Models</a><br/>
		    </li>
		    <li><span
			onmouseover="mopen('mDev')" 
			onmouseout="mclosetime()"
			>Develop &#x25BC;</span>
		      <div id="mDev"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_api"
			   href="/docs/doxygen/index.html"
			   >API</a><br/>
			<a id="ns3_bugs"
			   href="http://www.nsnam.org/bugzilla/">Bugs</a>
		    </li>
		  </ul>
		</div>
	      </td>
	      <td id="projectsection">
		<span style="margin-right:10px">API</span>
	      </td>
	    </tr>
	  </tbody>
	</table>
	<script  type="text/javascript">ns3_write_links();</script>
      </div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classns3_1_1_onion_routing.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classns3_1_1_onion_routing-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ns3::OnionRouting Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__onion-routing.html">Onion-routing</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstract class for creation and decryption of Onion messages.  
 <a href="classns3_1_1_onion_routing.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>&quot;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for ns3::OnionRouting:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing__inherit__graph.png" border="0" usemap="#ns3_1_1_onion_routing_inherit__map" alt="Inheritance graph"/></div>
<map name="ns3_1_1_onion_routing_inherit__map" id="ns3_1_1_onion_routing_inherit__map">
<area shape="rect" title="Abstract class for creation and decryption of Onion messages." alt="" coords="123,80,265,107"/>
<area shape="rect" href="classns3_1_1_onion_manager.html" title="Class that manages encryption keys and the encryption and decryption of layers of onion messagess The..." alt="" coords="5,155,153,181"/>
<area shape="rect" href="classns3_1_1_onion_routing_dummy_encryption.html" title="class that implements the" alt="" coords="177,155,440,181"/>
<area shape="rect" title=" " alt="" coords="162,5,226,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for ns3::OnionRouting:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing__coll__graph.png" border="0" usemap="#ns3_1_1_onion_routing_coll__map" alt="Collaboration graph"/></div>
<map name="ns3_1_1_onion_routing_coll__map" id="ns3_1_1_onion_routing_coll__map">
<area shape="rect" title="Abstract class for creation and decryption of Onion messages." alt="" coords="5,519,147,545"/>
<area shape="rect" title=" " alt="" coords="23,429,87,456"/>
<area shape="rect" title="STL class." alt="" coords="111,429,244,456"/>
<area shape="rect" title="STL class." alt="" coords="90,339,265,380"/>
<area shape="rect" title="STL class." alt="" coords="103,248,252,289"/>
<area shape="rect" title="STL class." alt="" coords="24,157,165,199"/>
<area shape="rect" title="STL class." alt="" coords="92,81,263,108"/>
<area shape="rect" title="STL class." alt="" coords="190,157,335,199"/>
<area shape="rect" title="STL class." alt="" coords="124,5,231,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9750c714d6691285ac6b1c82def129ae"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">OnionErrno</a> { <br />
&#160;&#160;<a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129aea881c9ff7b880598ae87b09b2b42e0e4f">ERROR_NOTERROR</a>, 
<a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129aea131b9b9582ae9d6ba53ab6e18f2f6823">ERROR_PROT_NUMBER</a>, 
<a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129aea72c74cab20ddc9352f8ea13b3bb1db06">ERROR_ROUTE_TO_SHORT</a>, 
<a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129aea7c10a9c9d2982d68b472dea0b157f5f1">ERROR_ENCRYPTION</a>, 
<br />
&#160;&#160;<a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129aea34c40698ce09f3beb1ebe790037dc2e8">ERROR_DECRYPTION</a>
<br />
 }</td></tr>
<tr class="memdesc:a9750c714d6691285ac6b1c82def129ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of the possible errors using the class onion-routing.  <a href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">More...</a><br /></td></tr>
<tr class="separator:a9750c714d6691285ac6b1c82def129ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab6769383004b2ff821afd5f26c837647"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#ab6769383004b2ff821afd5f26c837647">OnionRouting</a> ()</td></tr>
<tr class="separator:ab6769383004b2ff821afd5f26c837647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead911bf5ea2913e0311997e3cf9c410"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#aead911bf5ea2913e0311997e3cf9c410">OnionRouting</a> (uint16_t keySize, uint16_t sealPadding, uint16_t addressSize)</td></tr>
<tr class="separator:aead911bf5ea2913e0311997e3cf9c410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd9e08d34644631bfa3f105010083c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#acbd9e08d34644631bfa3f105010083c6">OnionRouting</a> (uint16_t sealPadding, const uint16_t protocolNumber)</td></tr>
<tr class="memdesc:acbd9e08d34644631bfa3f105010083c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor &ndash; Setup parameters for the creation of onions.  <a href="classns3_1_1_onion_routing.html#acbd9e08d34644631bfa3f105010083c6">More...</a><br /></td></tr>
<tr class="separator:acbd9e08d34644631bfa3f105010083c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9e9496857fc255da7cc123fe538d70"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#acd9e9496857fc255da7cc123fe538d70">~OnionRouting</a> ()</td></tr>
<tr class="separator:acd9e9496857fc255da7cc123fe538d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e89ab4789722e46a24403ef4fdca78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78">AddressToStream</a> (uint8_t *ip)</td></tr>
<tr class="separator:aa0e89ab4789722e46a24403ef4fdca78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e89ab4789722e46a24403ef4fdca78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78">AddressToStream</a> (uint8_t *ip)</td></tr>
<tr class="memdesc:aa0e89ab4789722e46a24403ef4fdca78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output an ip address to a stream variable, used to LOG the onion message.  <a href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78">More...</a><br /></td></tr>
<tr class="separator:aa0e89ab4789722e46a24403ef4fdca78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da1e54f52d99df702dd240fce651981"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a0da1e54f52d99df702dd240fce651981">BuildOnion</a> (uint8_t *cipher, uint8_t **route, uint16_t routeLen, uint8_t **keys, uint8_t *content, uint16_t contentLen)</td></tr>
<tr class="separator:a0da1e54f52d99df702dd240fce651981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4ff793cd75e01435fc925669b796ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a3b4ff793cd75e01435fc925669b796ca">BuildOnion</a> (uint8_t *cipher, uint8_t **route, uint8_t **keys, uint16_t routeLen)</td></tr>
<tr class="memdesc:a3b4ff793cd75e01435fc925669b796ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage construction of the onion ONION_NO_CONTENT.  <a href="classns3_1_1_onion_routing.html#a3b4ff793cd75e01435fc925669b796ca">More...</a><br /></td></tr>
<tr class="separator:a3b4ff793cd75e01435fc925669b796ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d91c96da6d4881cd26baf496e617394"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a3d91c96da6d4881cd26baf496e617394">BuildOnion</a> (uint8_t *cipher, uint8_t **route, uint8_t **keys, uint16_t routeLen, uint8_t *endContent, uint16_t endContentLen)</td></tr>
<tr class="memdesc:a3d91c96da6d4881cd26baf496e617394"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage construction of the onion ONION_ENDCONTENT.  <a href="classns3_1_1_onion_routing.html#a3d91c96da6d4881cd26baf496e617394">More...</a><br /></td></tr>
<tr class="separator:a3d91c96da6d4881cd26baf496e617394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f1b026453fe7d112b96a277636dc6e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a3f1b026453fe7d112b96a277636dc6e0">BuildOnion</a> (uint8_t *cipher, uint8_t **route, uint8_t **keys, uint8_t **layerContent, uint16_t layerContentLen, uint16_t routeLen)</td></tr>
<tr class="memdesc:a3f1b026453fe7d112b96a277636dc6e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage construction of the onion ONION_LAYERCONTENT.  <a href="classns3_1_1_onion_routing.html#a3f1b026453fe7d112b96a277636dc6e0">More...</a><br /></td></tr>
<tr class="separator:a3f1b026453fe7d112b96a277636dc6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ccc396a78f1e8154b6b7b059239020"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#ae8ccc396a78f1e8154b6b7b059239020">BuildOnion</a> (uint8_t *cipher, uint8_t **route, uint8_t **keys, uint8_t **layerContent, uint16_t layerContentLen, uint16_t routeLen, uint8_t *endContent, uint16_t endContentLen)</td></tr>
<tr class="memdesc:ae8ccc396a78f1e8154b6b7b059239020"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage construction of the onion ONION_LAYERCONTENT_ENDCONTENT.  <a href="classns3_1_1_onion_routing.html#ae8ccc396a78f1e8154b6b7b059239020">More...</a><br /></td></tr>
<tr class="separator:ae8ccc396a78f1e8154b6b7b059239020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c470892e46cdd55688d0187fd2318b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b">CreateOnion</a> (uint8_t *cipher, uint8_t **route, uint16_t index, uint16_t routeLen, uint8_t **keys, uint8_t *content, uint16_t contentLen)</td></tr>
<tr class="separator:af2c470892e46cdd55688d0187fd2318b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d734647ebc25fbd531f1764baa73a4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d">CreateOnion</a> (uint8_t *cipher, uint8_t **route, uint8_t **keys, uint16_t index, uint16_t routeLen, uint8_t **layerContent, uint16_t layerContentLen, uint8_t *endContent, uint16_t endContentLen)</td></tr>
<tr class="memdesc:a9d734647ebc25fbd531f1764baa73a4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs the onion message *.  <a href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d">More...</a><br /></td></tr>
<tr class="separator:a9d734647ebc25fbd531f1764baa73a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab30a9ad7b044ff278911f98d2840051"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#aab30a9ad7b044ff278911f98d2840051">DecryptLayer</a> (uint8_t *innerLayer, uint8_t *onion, uint16_t onionLen, uint8_t *pk, uint8_t *sk) const =0</td></tr>
<tr class="separator:aab30a9ad7b044ff278911f98d2840051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a531771d1db749317ab716ff5f8be1647"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a531771d1db749317ab716ff5f8be1647">DecryptLayer</a> (uint8_t *plaintext, uint8_t *ciphertext, uint16_t len, uint8_t *publicKey, uint8_t *secretKey) const =0</td></tr>
<tr class="memdesc:a531771d1db749317ab716ff5f8be1647"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual method, implement decryption  <a href="classns3_1_1_onion_routing.html#a531771d1db749317ab716ff5f8be1647">More...</a><br /></td></tr>
<tr class="separator:a531771d1db749317ab716ff5f8be1647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc0c7fbda4dccf41b5c3e5a5dda1a36"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36">EncryptLayer</a> (uint8_t *ciphertext, uint8_t *message, int len, uint8_t *key) const =0</td></tr>
<tr class="separator:a4dc0c7fbda4dccf41b5c3e5a5dda1a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6dbf87ecdb6152b2bd3de8ddad1610"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a9f6dbf87ecdb6152b2bd3de8ddad1610">EncryptLayer</a> (uint8_t *ciphertext, uint8_t *plaintext, int len, uint8_t *key) const =0</td></tr>
<tr class="memdesc:a9f6dbf87ecdb6152b2bd3de8ddad1610"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual method, implement encryption  <a href="classns3_1_1_onion_routing.html#a9f6dbf87ecdb6152b2bd3de8ddad1610">More...</a><br /></td></tr>
<tr class="separator:a9f6dbf87ecdb6152b2bd3de8ddad1610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e7e73ec50582c8d98bfa0d283a5f2ac"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">OnionErrno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a2e7e73ec50582c8d98bfa0d283a5f2ac">GetErrno</a> (void)</td></tr>
<tr class="memdesc:a2e7e73ec50582c8d98bfa0d283a5f2ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the last error code of the OnionErrno enum.  <a href="classns3_1_1_onion_routing.html#a2e7e73ec50582c8d98bfa0d283a5f2ac">More...</a><br /></td></tr>
<tr class="separator:a2e7e73ec50582c8d98bfa0d283a5f2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3882cb5b24d0746cfbca7db0a0f2307"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307">OnionLength</a> (uint16_t routeLen, uint16_t contentLen)</td></tr>
<tr class="separator:ab3882cb5b24d0746cfbca7db0a0f2307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4f32c62d7e7cbd786eba4b477282a5"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a4a4f32c62d7e7cbd786eba4b477282a5">OnionLength</a> (uint16_t routeLen, uint16_t layerContentLen, uint16_t endContentLen)</td></tr>
<tr class="memdesc:a4a4f32c62d7e7cbd786eba4b477282a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the length in bytes of the onion message at given parameters.  <a href="classns3_1_1_onion_routing.html#a4a4f32c62d7e7cbd786eba4b477282a5">More...</a><br /></td></tr>
<tr class="separator:a4a4f32c62d7e7cbd786eba4b477282a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad38d79e95a26a77a7ea7ccb4a7c39e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structns3_1_1or_layer.html">orLayer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#aad38d79e95a26a77a7ea7ccb4a7c39e0">PeelOnion</a> (uint8_t *onion, uint16_t onionLen, uint8_t *pk, uint8_t *sk)</td></tr>
<tr class="separator:aad38d79e95a26a77a7ea7ccb4a7c39e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd1b7d68e2a0d516cd140e056d2c0e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structns3_1_1or_layer.html">orLayer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a2cd1b7d68e2a0d516cd140e056d2c0e2">PeelOnion</a> (uint8_t *onion, uint16_t onionLen, uint8_t *publicKey, uint8_t *secretKey)</td></tr>
<tr class="memdesc:a2cd1b7d68e2a0d516cd140e056d2c0e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decipher the outer layer of the onion and return details.  <a href="classns3_1_1_onion_routing.html#a2cd1b7d68e2a0d516cd140e056d2c0e2">More...</a><br /></td></tr>
<tr class="separator:a2cd1b7d68e2a0d516cd140e056d2c0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a27155a9a4bf9faa5183c2169bd55bae9"><td class="memItemLeft" align="right" valign="top">static TypeId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a27155a9a4bf9faa5183c2169bd55bae9">GetTypeId</a> (void)</td></tr>
<tr class="separator:a27155a9a4bf9faa5183c2169bd55bae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9465d1de4f4f7d81b056e72fe870b57"><td class="memItemLeft" align="right" valign="top">static TypeId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#ae9465d1de4f4f7d81b056e72fe870b57">GetTypeId</a> (void)</td></tr>
<tr class="memdesc:ae9465d1de4f4f7d81b056e72fe870b57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register this type.  <a href="classns3_1_1_onion_routing.html#ae9465d1de4f4f7d81b056e72fe870b57">More...</a><br /></td></tr>
<tr class="separator:ae9465d1de4f4f7d81b056e72fe870b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a74694ab7cbea4c86f67f9997aa832bd1"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a74694ab7cbea4c86f67f9997aa832bd1">m_addressSize</a></td></tr>
<tr class="memdesc:a74694ab7cbea4c86f67f9997aa832bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">size in bytes of the used address type (4-Ipv4, 16-Ipv6)  <a href="classns3_1_1_onion_routing.html#a74694ab7cbea4c86f67f9997aa832bd1">More...</a><br /></td></tr>
<tr class="separator:a74694ab7cbea4c86f67f9997aa832bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1703369bd508421578dca3eced8f5b"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">OnionErrno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a0a1703369bd508421578dca3eced8f5b">m_errno</a></td></tr>
<tr class="memdesc:a0a1703369bd508421578dca3eced8f5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">error status while using the onion class  <a href="classns3_1_1_onion_routing.html#a0a1703369bd508421578dca3eced8f5b">More...</a><br /></td></tr>
<tr class="separator:a0a1703369bd508421578dca3eced8f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53d0e5b7804873417ae921e95d131227"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a53d0e5b7804873417ae921e95d131227">m_keySize</a></td></tr>
<tr class="separator:a53d0e5b7804873417ae921e95d131227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259af41ca36a0fb28174556915442bec"><td class="memItemLeft" align="right" valign="top">std::stringstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#a259af41ca36a0fb28174556915442bec">m_onionStream</a></td></tr>
<tr class="memdesc:a259af41ca36a0fb28174556915442bec"><td class="mdescLeft">&#160;</td><td class="mdescRight">stringstream used to LOG onion construction  <a href="classns3_1_1_onion_routing.html#a259af41ca36a0fb28174556915442bec">More...</a><br /></td></tr>
<tr class="separator:a259af41ca36a0fb28174556915442bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad70401fe637fa31eb16211770b016777"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classns3_1_1_onion_routing.html#ad70401fe637fa31eb16211770b016777">m_sealPadding</a></td></tr>
<tr class="memdesc:ad70401fe637fa31eb16211770b016777"><td class="mdescLeft">&#160;</td><td class="mdescRight">size increase of the ciphertext in bytes, intorduced by the encryption method  <a href="classns3_1_1_onion_routing.html#ad70401fe637fa31eb16211770b016777">More...</a><br /></td></tr>
<tr class="separator:ad70401fe637fa31eb16211770b016777"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstract class for creation and decryption of Onion messages. </p>
<p>The <a class="el" href="classns3_1_1_onion_routing.html" title="Abstract class for creation and decryption of Onion messages.">OnionRouting</a> abstract class include useful methods for the creation and redirection of <a href="https://en.wikipedia.org/wiki/Onion_routing">Onion Messages</a>. The given class can be used to construct onion messages of the following features:<br  />
 ONION_NO_CONTENT - onion message including only routing information<br  />
 example: (((10.1.1.2) 10.1.1.1) 10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p>ONION_ENDCONTENT - onion message including content to be delivered to the last node in the path<br  />
 example: ((((end_content,0.0.0.0) 10.1.1.2) 10.1.1.1) 10.1.1.5) 10.1.1.3<br  />
<br  />
</p>
<p>ONION_LAYERCONTENT - onion message including a content of fixed length (in bytes) in each layer<br  />
 example: ((((layer_content,0.0.0.0) layer_content,10.1.1.2) layer_content,10.1.1.1) layer_content,10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p>ONION_LAYERCONTENT_ENDCONTENT - onion message including a content of fixed length in each layer and content of arbitrary length to be delivered to the last node in the path<br  />
 example: ((((end_content,0.0.0.0) layer_content,10.1.1.2) layer_content,10.1.1.1) layer_content,10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p><br  />
The given class can be used to construct onion circuits as described in <em>Hiding</em> <em>Routing</em> <em>Information</em> by david M. Goldschlag, Micheal G. Reed, and Paul F. Syverson, May 1996<br  />
</p>
<p>We designed an abstract class to allow the use of an arbitrary encryption suite, by implementing methods EncryptLayer &amp; DecryptLayer</p>
<p>implementing dummy Encryption/Decryption methods.</p>
<p>The class simulates the use of encryption keys by including them into encryption layers of onion messages. A node deciphering a layer of the onion message will compare its encryption key with the encryption key included in the layer of the onion message. If the two keys match the layer is succesfully deciphered, otherwise the node is not the expected recipient of the onion message and the encryption will fail triggering an error message.</p>
<p>Since dummy encryption keys of 4B are included in each layer of the onion message, the parameter <code>m_sealPadding</code> must be set to at least 4 Bytes. The parameter <code>m_sealPadding</code> is used to emulate additional bytes introduced by a real encryption technique. This parameter is set in the constructor. </p>

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8h_source.html#l00029">29</a> of file <a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a9750c714d6691285ac6b1c82def129ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9750c714d6691285ac6b1c82def129ae">&#9670;&nbsp;</a></span>OnionErrno</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">ns3::OnionRouting::OnionErrno</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of the possible errors using the class onion-routing. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a9750c714d6691285ac6b1c82def129aea881c9ff7b880598ae87b09b2b42e0e4f"></a>ERROR_NOTERROR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a9750c714d6691285ac6b1c82def129aea131b9b9582ae9d6ba53ab6e18f2f6823"></a>ERROR_PROT_NUMBER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a9750c714d6691285ac6b1c82def129aea72c74cab20ddc9352f8ea13b3bb1db06"></a>ERROR_ROUTE_TO_SHORT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a9750c714d6691285ac6b1c82def129aea7c10a9c9d2982d68b472dea0b157f5f1"></a>ERROR_ENCRYPTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a9750c714d6691285ac6b1c82def129aea34c40698ce09f3beb1ebe790037dc2e8"></a>ERROR_DECRYPTION&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="onion-routing_8h_source.html#l00104">104</a> of file <a class="el" href="onion-routing_8h_source.html">onion-routing.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab6769383004b2ff821afd5f26c837647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6769383004b2ff821afd5f26c837647">&#9670;&nbsp;</a></span>OnionRouting() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ns3::OnionRouting::OnionRouting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00027">27</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

</div>
</div>
<a id="aead911bf5ea2913e0311997e3cf9c410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead911bf5ea2913e0311997e3cf9c410">&#9670;&nbsp;</a></span>OnionRouting() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ns3::OnionRouting::OnionRouting </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>keySize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sealPadding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addressSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00043">43</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00051">m_keySize</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>.</p>

</div>
</div>
<a id="acd9e9496857fc255da7cc123fe538d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9e9496857fc255da7cc123fe538d70">&#9670;&nbsp;</a></span>~OnionRouting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ns3::OnionRouting::~OnionRouting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00050">50</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

</div>
</div>
<a id="acbd9e08d34644631bfa3f105010083c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbd9e08d34644631bfa3f105010083c6">&#9670;&nbsp;</a></span>OnionRouting() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ns3::OnionRouting::OnionRouting </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sealPadding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>protocolNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor &ndash; Setup parameters for the creation of onions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sealPadding</td><td>size increase of the ciphertext in bytes, intorduced by the encryption method </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">protocolNumber</td><td>value detailing the utilized IP protocol: IPv4&ndash;Ipv4L3Protocol::PROT_NUMBER, IPv6&ndash;Ipv6L3Protocol::PROT_NUMBER </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00051">51</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="onion-routing_8h_source.html#l00105">ERROR_NOTERROR</a>, <a class="el" href="onion-routing_8h_source.html#l00106">ERROR_PROT_NUMBER</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa0e89ab4789722e46a24403ef4fdca78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e89ab4789722e46a24403ef4fdca78">&#9670;&nbsp;</a></span>AddressToStream() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::AddressToStream </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">200</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00063">BuildOnion()</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_aa0e89ab4789722e46a24403ef4fdca78_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_aa0e89ab4789722e46a24403ef4fdca78_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_aa0e89ab4789722e46a24403ef4fdca78_icgraph" id="classns3_1_1_onion_routing_aa0e89ab4789722e46a24403ef4fdca78_icgraph">
<area shape="rect" title=" " alt="" coords="1687,78,1836,119"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a0da1e54f52d99df702dd240fce651981" title=" " alt="" coords="1292,49,1441,90"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="1489,107,1639,149"/>
<area shape="rect" href="classns3_1_1_sink.html#afb970f60a50eeb59c9bbf77189716294" title="Method that constructs the onion head from route and routeLen parameters." alt="" coords="1067,56,1244,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a4a2b4bb96ca5a7f87779c9debe616c49" title="Schedule the creation of a new onion based on the path length specified in m_onionPathLengths If all ..." alt="" coords="865,56,1019,83"/>
<area shape="rect" href="classns3_1_1_sink.html#adb3593f0c5e1037d8a6cb429ff114b2e" title="Each five seconds call the ns3::OnionValidator and check if at least one onion message is alive Other..." alt="" coords="436,5,603,32"/>
<area shape="rect" href="classns3_1_1_sink.html#a59faa47e4235feac5d9be91842c82710" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,56,199,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a1580afa832d0c29fab74b36a386c5960" title="Triggered when an onion message is received back at the sink node Data about the message is captured ..." alt="" coords="659,107,817,133"/>
<area shape="rect" href="classns3_1_1_sink.html#afed3482312048d13efa38d1235bbf504" title="Recieve a new packet from socket Check if the packet is a handshake packet or a packet containing an ..." alt="" coords="428,107,611,133"/>
<area shape="rect" href="classns3_1_1_sink.html#a828baaddc6bd9c862ca1eab675a2cc8b" title="Accept new TCP connections." alt="" coords="247,107,380,133"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d" title="Constructs the onion message *." alt="" coords="1292,114,1441,155"/>
</map>
</div>

</div>
</div>
<a id="aa0e89ab4789722e46a24403ef4fdca78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e89ab4789722e46a24403ef4fdca78">&#9670;&nbsp;</a></span>AddressToStream() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::AddressToStream </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output an ip address to a stream variable, used to LOG the onion message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>serialized ip address </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0da1e54f52d99df702dd240fce651981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da1e54f52d99df702dd240fce651981">&#9670;&nbsp;</a></span>BuildOnion() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ns3::OnionRouting::BuildOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>content</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>contentLen</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00063">63</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>

<p class="reference">Referenced by <a class="el" href="sink_8cc_source.html#l00229">ns3::Sink::PrepareOnion()</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_cgraph" id="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,155,80"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,68,352,109"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,71,549,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,136,549,177"/>
</map>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_icgraph" id="classns3_1_1_onion_routing_a0da1e54f52d99df702dd240fce651981_icgraph">
<area shape="rect" title=" " alt="" coords="1292,49,1441,90"/>
<area shape="rect" href="classns3_1_1_sink.html#afb970f60a50eeb59c9bbf77189716294" title="Method that constructs the onion head from route and routeLen parameters." alt="" coords="1067,56,1244,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a4a2b4bb96ca5a7f87779c9debe616c49" title="Schedule the creation of a new onion based on the path length specified in m_onionPathLengths If all ..." alt="" coords="865,56,1019,83"/>
<area shape="rect" href="classns3_1_1_sink.html#adb3593f0c5e1037d8a6cb429ff114b2e" title="Each five seconds call the ns3::OnionValidator and check if at least one onion message is alive Other..." alt="" coords="436,5,603,32"/>
<area shape="rect" href="classns3_1_1_sink.html#a59faa47e4235feac5d9be91842c82710" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,56,199,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a1580afa832d0c29fab74b36a386c5960" title="Triggered when an onion message is received back at the sink node Data about the message is captured ..." alt="" coords="659,107,817,133"/>
<area shape="rect" href="classns3_1_1_sink.html#afed3482312048d13efa38d1235bbf504" title="Recieve a new packet from socket Check if the packet is a handshake packet or a packet containing an ..." alt="" coords="428,107,611,133"/>
<area shape="rect" href="classns3_1_1_sink.html#a828baaddc6bd9c862ca1eab675a2cc8b" title="Accept new TCP connections." alt="" coords="247,107,380,133"/>
</map>
</div>

</div>
</div>
<a id="a3b4ff793cd75e01435fc925669b796ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4ff793cd75e01435fc925669b796ca">&#9670;&nbsp;</a></span>BuildOnion() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::BuildOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manage construction of the onion ONION_NO_CONTENT. </p>
<p>The resulting onion message include only routing information and the last hop in the onion path will not recieve content example: (((10.1.1.2) 10.1.1.1) 10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p>Allow the construction of onions of route length &gt; 4, and manage the LOG output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cipher</td><td>memory locations on which the onion message will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">route</td><td>array of ip addresses defining the route of the onion message, ip addresses are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keys</td><td>array of encryption keys, keys are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the route parameter) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00077">77</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="onion-routing_8h_source.html#l00105">ERROR_NOTERROR</a>, <a class="el" href="onion-routing_8h_source.html#l00107">ERROR_ROUTE_TO_SHORT</a>, <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a3b4ff793cd75e01435fc925669b796ca_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a3b4ff793cd75e01435fc925669b796ca_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a3b4ff793cd75e01435fc925669b796ca_cgraph" id="classns3_1_1_onion_routing_a3b4ff793cd75e01435fc925669b796ca_cgraph">
<area shape="rect" title="Manage construction of the onion ONION_NO_CONTENT." alt="" coords="5,39,155,80"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,68,352,109"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,71,549,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,136,549,177"/>
</map>
</div>

</div>
</div>
<a id="a3d91c96da6d4881cd26baf496e617394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d91c96da6d4881cd26baf496e617394">&#9670;&nbsp;</a></span>BuildOnion() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::BuildOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>endContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>endContentLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manage construction of the onion ONION_ENDCONTENT. </p>
<p>The resulting onion message include routing information and the last hop in the onion path recieve the given content<br  />
 The zero address &ndash; 0.0.0.0 (ipv4) identifies the last hop in the path of the onion message<br  />
 example: ((((end_content,0.0.0.0) 10.1.1.2) 10.1.1.1) 10.1.1.5) 10.1.1.3<br  />
<br  />
</p>
<p>Allow the construction of onions of route length &gt; 4, and manage the LOG output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cipher</td><td>memory locations on which the onion message will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">route</td><td>array of ip addresses defining the route of the onion message, ip addresses are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keys</td><td>array of encryption keys, keys are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the <code>route</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContent</td><td>location of the content to forward to the last node in the onion message path </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContentLen</td><td>length in bytes of the data stored at <code>endContent</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00105">105</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="onion-routing_8h_source.html#l00105">ERROR_NOTERROR</a>, <a class="el" href="onion-routing_8h_source.html#l00107">ERROR_ROUTE_TO_SHORT</a>, <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a3d91c96da6d4881cd26baf496e617394_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a3d91c96da6d4881cd26baf496e617394_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a3d91c96da6d4881cd26baf496e617394_cgraph" id="classns3_1_1_onion_routing_a3d91c96da6d4881cd26baf496e617394_cgraph">
<area shape="rect" title="Manage construction of the onion ONION_ENDCONTENT." alt="" coords="5,39,155,80"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,68,352,109"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,71,549,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,136,549,177"/>
</map>
</div>

</div>
</div>
<a id="a3f1b026453fe7d112b96a277636dc6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f1b026453fe7d112b96a277636dc6e0">&#9670;&nbsp;</a></span>BuildOnion() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::BuildOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>layerContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>layerContentLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manage construction of the onion ONION_LAYERCONTENT. </p>
<p>The resulting onion message include only routing information, and each hop in the route will receive data stored in <code>layerContent</code> <br  />
 The zero address &ndash; 0.0.0.0 (ipv4) identifies the last hop in the path of the onion message<br  />
 example: ((((layer_content,0.0.0.0) layer_content,10.1.1.2) layer_content,10.1.1.1) layer_content,10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p>Allow the construction of onions of route length &gt; 4, and manage the LOG output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cipher</td><td>memory locations on which the onion message will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">route</td><td>array of ip addresses defining the route of the onion message, ip addresses are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keys</td><td>array of encryption keys, keys are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContent</td><td>array of of pointers, pointing to data to be stored in a layer of the onion message the data is of fixed length in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContentLen</td><td>length in bytes of the data to be stored in each layer of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the <code>route</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00133">133</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="onion-routing_8h_source.html#l00105">ERROR_NOTERROR</a>, <a class="el" href="onion-routing_8h_source.html#l00107">ERROR_ROUTE_TO_SHORT</a>, <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a3f1b026453fe7d112b96a277636dc6e0_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a3f1b026453fe7d112b96a277636dc6e0_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a3f1b026453fe7d112b96a277636dc6e0_cgraph" id="classns3_1_1_onion_routing_a3f1b026453fe7d112b96a277636dc6e0_cgraph">
<area shape="rect" title="Manage construction of the onion ONION_LAYERCONTENT." alt="" coords="5,39,155,80"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,68,352,109"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,71,549,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,136,549,177"/>
</map>
</div>

</div>
</div>
<a id="ae8ccc396a78f1e8154b6b7b059239020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ccc396a78f1e8154b6b7b059239020">&#9670;&nbsp;</a></span>BuildOnion() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::BuildOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>layerContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>layerContentLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>endContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>endContentLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manage construction of the onion ONION_LAYERCONTENT_ENDCONTENT. </p>
<p>The resulting onion message include only routing information, each hop in the route will receive data stored in <code>layerContent</code>, the last hop in the onion path recieve content only data stored in <code>endContent</code> <br  />
 The zero address &ndash; 0.0.0.0 (ipv4) identifies the last hop in the path of the onion message<br  />
 example: ((((end_content,0.0.0.0) layer_content,10.1.1.2) layer_content,10.1.1.1) layer_content,10.1.1.5)10.1.1.3<br  />
<br  />
</p>
<p>Allow the construction of onions of route length &gt; 4, and manage the LOG output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cipher</td><td>memory locations on which the onion message will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">route</td><td>array of ip addresses defining the route of the onion message, ip addresses are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keys</td><td>array of encryption keys, keys are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContent</td><td>array of of pointers, pointing to data to be stored in a layer of the onion message the data is of fixed length in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContentLen</td><td>length in bytes of the data to be stored in each layer of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the <code>route</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContent</td><td>location of the content to forward to the last node in the onion message path </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContentLen</td><td>length in bytes of the data stored at <code>endContent</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00160">160</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="onion-routing_8h_source.html#l00105">ERROR_NOTERROR</a>, <a class="el" href="onion-routing_8h_source.html#l00107">ERROR_ROUTE_TO_SHORT</a>, <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_ae8ccc396a78f1e8154b6b7b059239020_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_ae8ccc396a78f1e8154b6b7b059239020_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_ae8ccc396a78f1e8154b6b7b059239020_cgraph" id="classns3_1_1_onion_routing_ae8ccc396a78f1e8154b6b7b059239020_cgraph">
<area shape="rect" title="Manage construction of the onion ONION_LAYERCONTENT_ENDCONTENT." alt="" coords="5,39,155,80"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,68,352,109"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,71,549,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,136,549,177"/>
</map>
</div>

</div>
</div>
<a id="af2c470892e46cdd55688d0187fd2318b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c470892e46cdd55688d0187fd2318b">&#9670;&nbsp;</a></span>CreateOnion() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ns3::OnionRouting::CreateOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>content</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>contentLen</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">103</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36">EncryptLayer()</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00180">OnionLength()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00063">BuildOnion()</a>, and <a class="el" href="onion-routing_8cc_source.html#l00185">CreateOnion()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_cgraph" id="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,155,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="203,5,352,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="203,71,352,112"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="203,136,352,177"/>
</map>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_icgraph" id="classns3_1_1_onion_routing_af2c470892e46cdd55688d0187fd2318b_icgraph">
<area shape="rect" title=" " alt="" coords="1489,82,1639,123"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a0da1e54f52d99df702dd240fce651981" title=" " alt="" coords="1292,49,1441,90"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d" title="Constructs the onion message *." alt="" coords="1292,114,1441,155"/>
<area shape="rect" href="classns3_1_1_sink.html#afb970f60a50eeb59c9bbf77189716294" title="Method that constructs the onion head from route and routeLen parameters." alt="" coords="1067,56,1244,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a4a2b4bb96ca5a7f87779c9debe616c49" title="Schedule the creation of a new onion based on the path length specified in m_onionPathLengths If all ..." alt="" coords="865,56,1019,83"/>
<area shape="rect" href="classns3_1_1_sink.html#adb3593f0c5e1037d8a6cb429ff114b2e" title="Each five seconds call the ns3::OnionValidator and check if at least one onion message is alive Other..." alt="" coords="436,5,603,32"/>
<area shape="rect" href="classns3_1_1_sink.html#a59faa47e4235feac5d9be91842c82710" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,56,199,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a1580afa832d0c29fab74b36a386c5960" title="Triggered when an onion message is received back at the sink node Data about the message is captured ..." alt="" coords="659,107,817,133"/>
<area shape="rect" href="classns3_1_1_sink.html#afed3482312048d13efa38d1235bbf504" title="Recieve a new packet from socket Check if the packet is a handshake packet or a packet containing an ..." alt="" coords="428,107,611,133"/>
<area shape="rect" href="classns3_1_1_sink.html#a828baaddc6bd9c862ca1eab675a2cc8b" title="Accept new TCP connections." alt="" coords="247,107,380,133"/>
</map>
</div>

</div>
</div>
<a id="a9d734647ebc25fbd531f1764baa73a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d734647ebc25fbd531f1764baa73a4d">&#9670;&nbsp;</a></span>CreateOnion() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns3::OnionRouting::CreateOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>layerContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>layerContentLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>endContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>endContentLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs the onion message *. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cipher</td><td>memory on which the onion message will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">route</td><td>array of ip addresses defining the route of the onion message, ip addresses are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keys</td><td>array of encryption keys, keys are stored in the serialized form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContent</td><td>array of of pointers, pointing to data to be stored in a layer of the onion message the data is of fixed length in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContentLen</td><td>length in bytes of the data to be stored in each layer of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>additional parameter used for the construction of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the <code>route</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContent</td><td>location of the content to forward to the last node in the onion message path </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContentLen</td><td>length in bytes of the data stored at <code>endContent</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00185">185</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36">EncryptLayer()</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">m_onionStream</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00180">OnionLength()</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a9d734647ebc25fbd531f1764baa73a4d_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a9d734647ebc25fbd531f1764baa73a4d_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a9d734647ebc25fbd531f1764baa73a4d_cgraph" id="classns3_1_1_onion_routing_a9d734647ebc25fbd531f1764baa73a4d_cgraph">
<area shape="rect" title="Constructs the onion message *." alt="" coords="5,88,155,129"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aa0e89ab4789722e46a24403ef4fdca78" title=" " alt="" coords="400,5,549,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="203,59,352,100"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a4dc0c7fbda4dccf41b5c3e5a5dda1a36" title=" " alt="" coords="400,75,549,116"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#ab3882cb5b24d0746cfbca7db0a0f2307" title=" " alt="" coords="400,149,549,191"/>
</map>
</div>

</div>
</div>
<a id="aab30a9ad7b044ff278911f98d2840051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab30a9ad7b044ff278911f98d2840051">&#9670;&nbsp;</a></span>DecryptLayer() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ns3::OnionRouting::DecryptLayer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>innerLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>onion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>onionLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classns3_1_1_onion_routing_dummy_encryption.html#a299d6ea951245e706941a15d3cc0e417">ns3::OnionRoutingDummyEncryption</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00158">PeelOnion()</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_aab30a9ad7b044ff278911f98d2840051_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_aab30a9ad7b044ff278911f98d2840051_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_aab30a9ad7b044ff278911f98d2840051_icgraph" id="classns3_1_1_onion_routing_aab30a9ad7b044ff278911f98d2840051_icgraph">
<area shape="rect" title=" " alt="" coords="1200,5,1349,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aad38d79e95a26a77a7ea7ccb4a7c39e0" title=" " alt="" coords="1003,5,1152,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#a7af9c6eb1656e6c7beac49a4b264f5ef" title="Decrypt the outer layer of the onion head, obtain the information of the next IP address,..." alt="" coords="765,5,955,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#a2ba651e5a5565303c912149f3cfbcc8c" title="Executed when a new onion is received." alt="" coords="527,5,717,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#aa733c01cc8db7d1dfe029c320c4f621c" title="Accept new TCP connections." alt="" coords="296,13,479,39"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#af104e475384f179e14699a7cf78dac43" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,13,248,39"/>
</map>
</div>

</div>
</div>
<a id="a531771d1db749317ab716ff5f8be1647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a531771d1db749317ab716ff5f8be1647">&#9670;&nbsp;</a></span>DecryptLayer() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ns3::OnionRouting::DecryptLayer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>publicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>secretKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>virtual method, implement decryption </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plaintext</td><td>memory locations containing the decrypted data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ciphertext</td><td>memory locations containing the encrypted data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length in bytes of the <code>ciphertext</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">publicKey</td><td>encryption key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secretKey</td><td>encryption key </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classns3_1_1_onion_routing_dummy_encryption.html#a299d6ea951245e706941a15d3cc0e417">ns3::OnionRoutingDummyEncryption</a>.</p>

</div>
</div>
<a id="a4dc0c7fbda4dccf41b5c3e5a5dda1a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dc0c7fbda4dccf41b5c3e5a5dda1a36">&#9670;&nbsp;</a></span>EncryptLayer() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ns3::OnionRouting::EncryptLayer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classns3_1_1_onion_routing_dummy_encryption.html#a4dfc8de08ce6618d9d5bd5f7a989c533">ns3::OnionRoutingDummyEncryption</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>.</p>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_a4dc0c7fbda4dccf41b5c3e5a5dda1a36_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_a4dc0c7fbda4dccf41b5c3e5a5dda1a36_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_a4dc0c7fbda4dccf41b5c3e5a5dda1a36_icgraph" id="classns3_1_1_onion_routing_a4dc0c7fbda4dccf41b5c3e5a5dda1a36_icgraph">
<area shape="rect" title=" " alt="" coords="1687,82,1836,123"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="1489,82,1639,123"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a0da1e54f52d99df702dd240fce651981" title=" " alt="" coords="1292,49,1441,90"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d" title="Constructs the onion message *." alt="" coords="1292,114,1441,155"/>
<area shape="rect" href="classns3_1_1_sink.html#afb970f60a50eeb59c9bbf77189716294" title="Method that constructs the onion head from route and routeLen parameters." alt="" coords="1067,56,1244,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a4a2b4bb96ca5a7f87779c9debe616c49" title="Schedule the creation of a new onion based on the path length specified in m_onionPathLengths If all ..." alt="" coords="865,56,1019,83"/>
<area shape="rect" href="classns3_1_1_sink.html#adb3593f0c5e1037d8a6cb429ff114b2e" title="Each five seconds call the ns3::OnionValidator and check if at least one onion message is alive Other..." alt="" coords="436,5,603,32"/>
<area shape="rect" href="classns3_1_1_sink.html#a59faa47e4235feac5d9be91842c82710" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,56,199,83"/>
<area shape="rect" href="classns3_1_1_sink.html#a1580afa832d0c29fab74b36a386c5960" title="Triggered when an onion message is received back at the sink node Data about the message is captured ..." alt="" coords="659,107,817,133"/>
<area shape="rect" href="classns3_1_1_sink.html#afed3482312048d13efa38d1235bbf504" title="Recieve a new packet from socket Check if the packet is a handshake packet or a packet containing an ..." alt="" coords="428,107,611,133"/>
<area shape="rect" href="classns3_1_1_sink.html#a828baaddc6bd9c862ca1eab675a2cc8b" title="Accept new TCP connections." alt="" coords="247,107,380,133"/>
</map>
</div>

</div>
</div>
<a id="a9f6dbf87ecdb6152b2bd3de8ddad1610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f6dbf87ecdb6152b2bd3de8ddad1610">&#9670;&nbsp;</a></span>EncryptLayer() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ns3::OnionRouting::EncryptLayer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>virtual method, implement encryption </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ciphertext</td><td>memory on which the ciphertext will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plaintext</td><td>memory locations containing the data to be encrypted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length in bytes of the <code>plaintext</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>encryption key </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classns3_1_1_onion_routing_dummy_encryption.html#a4dfc8de08ce6618d9d5bd5f7a989c533">ns3::OnionRoutingDummyEncryption</a>.</p>

</div>
</div>
<a id="a2e7e73ec50582c8d98bfa0d283a5f2ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e7e73ec50582c8d98bfa0d283a5f2ac">&#9670;&nbsp;</a></span>GetErrno()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">OnionRouting::OnionErrno</a> ns3::OnionRouting::GetErrno </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the last error code of the OnionErrno enum. </p>
<dl class="section return"><dt>Returns</dt><dd>OnionErrno enum, if != 0 THEN signals ERROR </dd></dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00292">292</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="onion-routing_8h_source.html#l00320">m_errno</a>.</p>

</div>
</div>
<a id="a27155a9a4bf9faa5183c2169bd55bae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27155a9a4bf9faa5183c2169bd55bae9">&#9670;&nbsp;</a></span>GetTypeId() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TypeId ns3::OnionRouting::GetTypeId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00017">17</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

</div>
</div>
<a id="ae9465d1de4f4f7d81b056e72fe870b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9465d1de4f4f7d81b056e72fe870b57">&#9670;&nbsp;</a></span>GetTypeId() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static TypeId ns3::OnionRouting::GetTypeId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register this type. </p>
<dl class="section return"><dt>Returns</dt><dd>The object TypeId. </dd></dl>

</div>
</div>
<a id="ab3882cb5b24d0746cfbca7db0a0f2307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3882cb5b24d0746cfbca7db0a0f2307">&#9670;&nbsp;</a></span>OnionLength() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ns3::OnionRouting::OnionLength </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>contentLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00180">180</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, and <a class="el" href="sink_8cc_source.html#l00229">ns3::Sink::PrepareOnion()</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_ab3882cb5b24d0746cfbca7db0a0f2307_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_ab3882cb5b24d0746cfbca7db0a0f2307_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_ab3882cb5b24d0746cfbca7db0a0f2307_icgraph" id="classns3_1_1_onion_routing_ab3882cb5b24d0746cfbca7db0a0f2307_icgraph">
<area shape="rect" title=" " alt="" coords="1687,100,1836,141"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#af2c470892e46cdd55688d0187fd2318b" title=" " alt="" coords="1489,71,1639,112"/>
<area shape="rect" href="classns3_1_1_sink.html#afb970f60a50eeb59c9bbf77189716294" title="Method that constructs the onion head from route and routeLen parameters." alt="" coords="1067,75,1244,102"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a0da1e54f52d99df702dd240fce651981" title=" " alt="" coords="1292,5,1441,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#a9d734647ebc25fbd531f1764baa73a4d" title="Constructs the onion message *." alt="" coords="1292,71,1441,112"/>
<area shape="rect" href="classns3_1_1_sink.html#a4a2b4bb96ca5a7f87779c9debe616c49" title="Schedule the creation of a new onion based on the path length specified in m_onionPathLengths If all ..." alt="" coords="865,75,1019,102"/>
<area shape="rect" href="classns3_1_1_sink.html#adb3593f0c5e1037d8a6cb429ff114b2e" title="Each five seconds call the ns3::OnionValidator and check if at least one onion message is alive Other..." alt="" coords="436,25,603,51"/>
<area shape="rect" href="classns3_1_1_sink.html#a59faa47e4235feac5d9be91842c82710" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,75,199,102"/>
<area shape="rect" href="classns3_1_1_sink.html#a1580afa832d0c29fab74b36a386c5960" title="Triggered when an onion message is received back at the sink node Data about the message is captured ..." alt="" coords="659,126,817,153"/>
<area shape="rect" href="classns3_1_1_sink.html#afed3482312048d13efa38d1235bbf504" title="Recieve a new packet from socket Check if the packet is a handshake packet or a packet containing an ..." alt="" coords="428,126,611,153"/>
<area shape="rect" href="classns3_1_1_sink.html#a828baaddc6bd9c862ca1eab675a2cc8b" title="Accept new TCP connections." alt="" coords="247,126,380,153"/>
</map>
</div>

</div>
</div>
<a id="a4a4f32c62d7e7cbd786eba4b477282a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a4f32c62d7e7cbd786eba4b477282a5">&#9670;&nbsp;</a></span>OnionLength() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ns3::OnionRouting::OnionLength </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>routeLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>layerContentLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>endContentLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the length in bytes of the onion message at given parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">routeLen</td><td>the length of the route that the onion message will travel (equal to the number of ip addresses stored in the <code>route</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layerContentLen</td><td>length in bytes of the data to be stored in layers of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endContentLen</td><td>length in bytes of the data stored in the last hop's layer of the onion message</td></tr>
  </table>
  </dd>
</dl>
<p><br  />
 </p><dl class="section return"><dt>Returns</dt><dd>an integer detailing the length in bytes of the onion message at given parameters </dd></dl>

<p class="definition">Definition at line <a class="el" href="onion-routing_8cc_source.html#l00259">259</a> of file <a class="el" href="onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>.</p>

</div>
</div>
<a id="aad38d79e95a26a77a7ea7ccb4a7c39e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad38d79e95a26a77a7ea7ccb4a7c39e0">&#9670;&nbsp;</a></span>PeelOnion() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structns3_1_1or_layer.html">orLayer</a> * ns3::OnionRouting::PeelOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>onion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>onionLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8cc_source.html#l00158">158</a> of file <a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a>.</p>

<p class="reference">References <a class="el" href="classns3_1_1_onion_routing.html#aab30a9ad7b044ff278911f98d2840051">DecryptLayer()</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00024">ns3::orLayer::innerLayer</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00025">ns3::orLayer::innerLayerLen</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">m_addressSize</a>, <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">m_sealPadding</a>, and <a class="el" href="bckp_2onion-routing_8h_source.html#l00023">ns3::orLayer::nextHopIP</a>.</p>

<p class="reference">Referenced by <a class="el" href="sensornode_8cc_source.html#l00131">ns3::SensorNode::ProcessOnionHead()</a>.</p>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_cgraph.png" border="0" usemap="#classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_cgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_cgraph" id="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,47"/>
<area shape="rect" href="classns3_1_1_onion_routing.html#aab30a9ad7b044ff278911f98d2840051" title=" " alt="" coords="203,5,352,47"/>
</map>
</div>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_icgraph.png" border="0" usemap="#classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_icgraph" alt=""/></div>
<map name="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_icgraph" id="classns3_1_1_onion_routing_aad38d79e95a26a77a7ea7ccb4a7c39e0_icgraph">
<area shape="rect" title=" " alt="" coords="1003,5,1152,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#a7af9c6eb1656e6c7beac49a4b264f5ef" title="Decrypt the outer layer of the onion head, obtain the information of the next IP address,..." alt="" coords="765,5,955,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#a2ba651e5a5565303c912149f3cfbcc8c" title="Executed when a new onion is received." alt="" coords="527,5,717,47"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#aa733c01cc8db7d1dfe029c320c4f621c" title="Accept new TCP connections." alt="" coords="296,13,479,39"/>
<area shape="rect" href="classns3_1_1_sensor_node.html#af104e475384f179e14699a7cf78dac43" title="1.Start the application run ns3::Wsn_node::Configure() 2.Generate new encryption keys 3...." alt="" coords="5,13,248,39"/>
</map>
</div>

</div>
</div>
<a id="a2cd1b7d68e2a0d516cd140e056d2c0e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cd1b7d68e2a0d516cd140e056d2c0e2">&#9670;&nbsp;</a></span>PeelOnion() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structns3_1_1or_layer.html">orLayer</a>* ns3::OnionRouting::PeelOnion </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>onion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>onionLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>publicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>secretKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decipher the outer layer of the onion and return details. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">onion</td><td>the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">onionLen</td><td>the length in bytes of the onion message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">publicKey</td><td>encryption key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secretKey</td><td>encryption key <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structns3_1_1or_layer.html" title="structure holding details resulting from layer decryption of an onion message">orLayer</a> * struct holding onion layer details </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a74694ab7cbea4c86f67f9997aa832bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74694ab7cbea4c86f67f9997aa832bd1">&#9670;&nbsp;</a></span>m_addressSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ns3::OnionRouting::m_addressSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>size in bytes of the used address type (4-Ipv4, 16-Ipv6) </p>

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8h_source.html#l00052">52</a> of file <a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00180">OnionLength()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00043">OnionRouting()</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00158">PeelOnion()</a>.</p>

</div>
</div>
<a id="a0a1703369bd508421578dca3eced8f5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1703369bd508421578dca3eced8f5b">&#9670;&nbsp;</a></span>m_errno</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classns3_1_1_onion_routing.html#a9750c714d6691285ac6b1c82def129ae">OnionErrno</a> ns3::OnionRouting::m_errno</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>error status while using the onion class </p>

<p class="definition">Definition at line <a class="el" href="onion-routing_8h_source.html#l00320">320</a> of file <a class="el" href="onion-routing_8h_source.html">onion-routing.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="onion-routing_8cc_source.html#l00077">BuildOnion()</a>, <a class="el" href="onion-routing_8cc_source.html#l00349">ns3::OnionRoutingDummyEncryption::DecryptLayer()</a>, <a class="el" href="onion-routing_8cc_source.html#l00292">GetErrno()</a>, and <a class="el" href="onion-routing_8cc_source.html#l00051">OnionRouting()</a>.</p>

</div>
</div>
<a id="a53d0e5b7804873417ae921e95d131227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53d0e5b7804873417ae921e95d131227">&#9670;&nbsp;</a></span>m_keySize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ns3::OnionRouting::m_keySize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8h_source.html#l00051">51</a> of file <a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00043">OnionRouting()</a>.</p>

</div>
</div>
<a id="a259af41ca36a0fb28174556915442bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259af41ca36a0fb28174556915442bec">&#9670;&nbsp;</a></span>m_onionStream</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::stringstream ns3::OnionRouting::m_onionStream</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stringstream used to LOG onion construction </p>

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8h_source.html#l00056">56</a> of file <a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00200">AddressToStream()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00063">BuildOnion()</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>.</p>

</div>
</div>
<a id="ad70401fe637fa31eb16211770b016777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad70401fe637fa31eb16211770b016777">&#9670;&nbsp;</a></span>m_sealPadding</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ns3::OnionRouting::m_sealPadding</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>size increase of the ciphertext in bytes, intorduced by the encryption method </p>

<p class="definition">Definition at line <a class="el" href="bckp_2onion-routing_8h_source.html#l00050">50</a> of file <a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="bckp_2onion-routing_8cc_source.html#l00103">CreateOnion()</a>, <a class="el" href="onion-routing_8cc_source.html#l00349">ns3::OnionRoutingDummyEncryption::DecryptLayer()</a>, <a class="el" href="onion-routing_8cc_source.html#l00338">ns3::OnionRoutingDummyEncryption::EncryptLayer()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00180">OnionLength()</a>, <a class="el" href="bckp_2onion-routing_8cc_source.html#l00043">OnionRouting()</a>, and <a class="el" href="bckp_2onion-routing_8cc_source.html#l00158">PeelOnion()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/onion-routing/model/bckp/<a class="el" href="bckp_2onion-routing_8h_source.html">onion-routing.h</a></li>
<li>src/onion-routing/model/bckp/<a class="el" href="bckp_2onion-routing_8cc_source.html">onion-routing.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacens3.html">ns3</a></li><li class="navelem"><a class="el" href="classns3_1_1_onion_routing.html">OnionRouting</a></li>
    <li class="footer">Generated on Fri Nov 26 2021 11:35:36 for ns-3 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
